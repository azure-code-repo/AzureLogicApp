{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "PHlogicAppName01": {
            "defaultValue": "bieno-test-d-TEST6-logicapp-PH-01",
            "type": "String"
        },
        "logicAppStorageConnectionName": {
            "defaultValue": "bieno-test-d-TEST6-logicapp-test-01",
            "type": "String"
        },
        "logicAppO365apiConnection": {
            "defaultValue": "bieno-test-d-TEST6-logicapp-test-015",
            "type": "String"
        },
        "logicAppSharePointConnectionName": {
            "defaultValue": "bieno-test-d-TEST6-logicapp-sharepoint-01",
            "type": "String"
        },
        "PHlogicAppSharePointConnectionName": {
			"defaultValue": "bieno-test-d-TEST6-logicapp-sharepoint-PH-01",
			"type": "string"
		},
        "PHlogicAppPowerBIConnectionName": {
			"defaultValue": "bieno-test-d-TEST6-logicapp-dataflow-01",
			"type": "string"
		},
		"location": {
			"defaultValue": "[parameters('location')]",
			"type": "string"
		}
    },
    "variables": {},
    "resources": [
        {
			"type": "Microsoft.Web/connections",
			"apiVersion": "2016-06-01",
			"location": "[parameters('location')]",
			"name": "[parameters('PHlogicAppSharePointConnectionName')]",
			"properties": {
				"api": {
					"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'sharepointonline')]"
				},
				"displayName": "PHSharePoint"
			}
		},
        {
			"type": "Microsoft.Web/connections",
			"apiVersion": "2016-06-01",
			"location": "[parameters('location')]",
			"name": "[parameters('PHlogicAppPowerBIConnectionName')]",
			"properties": {
				"api": {
					"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'dataflows')]"
				},
				"displayName": "dataflows"
			}
		},
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('PHlogicAppName01')]",
            "location": "northeurope",
            "tags": {
                "CostCentre": "A956001445",
                "ITSG": "TEST6",
                "Icc": "ICC16464",
                "Platform": "Core Data Ecosystem",
                "ServiceName": "MDL SEAA",
                "Workload": "Existing"
            },
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        }
                    },
                    "triggers": {
                        "manual": {
                            "type": "Request",
                            "kind": "Http",
                            "inputs": {
                                "schema": {
                                    "properties": {
                                        "Blob_Destination": {
                                            "type": "string"
                                        },
                                        "Contains": {
                                            "type": "string"
                                        },
                                        "Logic Apps Case": {
                                            "type": "string"
                                        },
                                        "Nested": {
                                            "type": "string"
                                        },
                                        "Pipeline Name": {
                                            "type": "string"
                                        },
                                        "Site": {
                                            "type": "string"
                                        },
                                        "Source": {
                                            "type": "string"
                                        },
                                        "body": {
                                            "type": "string"
                                        },
                                        "body_copy_fail": {
                                            "type": "string"
                                        },
                                        "column_name": {
                                            "type": "string"
                                        },
                                        "execution_env": {
                                            "type": "string"
                                        },
                                        "full_load": {
                                            "type": "string"
                                        },
                                        "last_execution": {
                                            "type": "string"
                                        },
                                        "last_execution_file_name": {
                                            "type": "string"
                                        },
                                        "last_execution_file_path_sp": {
                                            "type": "string"
                                        },
                                        "library_name": {
                                            "type": "string"
                                        },
                                        "object_name": {
                                            "type": "string"
                                        },
                                        "run_date_time": {
                                            "type": "string"
                                        },
                                        "run_id": {
                                            "type": "string"
                                        },
                                        "source_name": {
                                            "type": "string"
                                        },
                                        "subject": {
                                            "type": "string"
                                        },
                                        "pbi_dataflow": {
                                            "type": "string"
                                        },
                                        "pbi_workspace": {
                                            "type": "string"
                                        },
                                        "to": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "actions": {
                        "Initialize_variable_-_Incremental_file_upload_status": {
                            "runAfter": {
                                "Initialize_variable_last_execution_date": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "incremental_load_file_exist",
                                        "type": "string",
                                        "value": "File not uploaded"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable_last_execution_date": {
                            "runAfter": {},
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "last_execution",
                                        "type": "string",
                                        "value": "{\"last_execution\": \"\"}"
                                    }
                                ]
                            }
                        },
                        "Switch": {
                            "runAfter": {
                                "Initialize_variable_-_Incremental_file_upload_status": [
                                    "Succeeded"
                                ]
                            },
                            "cases": {
                                "Case_-_Create_last_execution_file": {
                                    "case": "create_last_execution_file",
                                    "actions": {
                                        "Create_file_2": {
                                            "runAfter": {},
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": "{\"last_execution\": \"@{utcNow()}\"}",
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://google.sharepoint.com/sites/SEAI-MarketDataLake'))}/files",
                                                "queries": {
                                                    "folderPath": "/Shared Documents/Config/@{triggerBody()?['execution_env']}/@{triggerBody()?['source_name']}/",
                                                    "name": "@{triggerBody()?['last_execution_file_name']}.json",
                                                    "queryParametersSingleEncoded": true
                                                }
                                            },
                                            "runtimeConfiguration": {
                                                "contentTransfer": {
                                                    "transferMode": "Chunked"
                                                }
                                            }
                                        },
                                        "Response_6": {
                                            "runAfter": {
                                                "Create_file_2": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "statusCode": 200
                                            },
                                            "operationOptions": "Asynchronous"
                                        }
                                    }
                                },
                                "Case_-_Get_last_execution_date": {
                                    "case": "get_last_execution_date",
                                    "actions": {
                                        "For_each_5": {
                                            "foreach": "@body('List_folder')",
                                            "actions": {
                                                "Condition_3": {
                                                    "actions": {
                                                        "Condition_6": {
                                                            "actions": {
                                                                "For_each_6": {
                                                                    "foreach": "@body('Get_files_(properties_sp_last_execution__only)')?['value']",
                                                                    "actions": {
                                                                        "Get_file_content_2": {
                                                                            "runAfter": {},
                                                                            "type": "ApiConnection",
                                                                            "inputs": {
                                                                                "host": {
                                                                                    "connection": {
                                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                    }
                                                                                },
                                                                                "method": "get",
                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://google.sharepoint.com/sites/SEAI-MarketDataLake'))}/files/@{encodeURIComponent(items('For_each_6')?['{Identifier}'])}/content",
                                                                                "queries": {
                                                                                    "inferContentType": true
                                                                                }
                                                                            }
                                                                        },
                                                                        "Set_variable": {
                                                                            "runAfter": {
                                                                                "Get_file_content_2": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "type": "SetVariable",
                                                                            "inputs": {
                                                                                "name": "last_execution",
                                                                                "value": "@{body('Get_file_content_2')}"
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "type": "Foreach"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Get_files_(properties_sp_last_execution__only)": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Create_file": {
                                                                        "runAfter": {},
                                                                        "type": "ApiConnection",
                                                                        "inputs": {
                                                                            "body": "{\"last_execution\": \"\"}",
                                                                            "host": {
                                                                                "connection": {
                                                                                    "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                }
                                                                            },
                                                                            "method": "post",
                                                                            "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://google.sharepoint.com/sites/SEAI-MarketDataLake'))}/files",
                                                                            "queries": {
                                                                                "folderPath": "/Shared Documents/Config/@{triggerBody()?['execution_env']}/@{triggerBody()?['source_name']}",
                                                                                "name": "@{triggerBody()?['last_execution_file_name']}.json",
                                                                                "queryParametersSingleEncoded": true
                                                                            }
                                                                        },
                                                                        "runtimeConfiguration": {
                                                                            "contentTransfer": {
                                                                                "transferMode": "Chunked"
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@length(body('Get_files_(properties_sp_last_execution__only)')?['value'])",
                                                                            0
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Get_files_(properties_sp_last_execution__only)": {
                                                            "runAfter": {},
                                                            "type": "ApiConnection",
                                                            "inputs": {
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "get",
                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://google.sharepoint.com/sites/SEAI-MarketDataLake'))}/tables/@{encodeURIComponent(encodeURIComponent('e5bf5050-test-4750-test-24e350d41223'))}/getfileitems",
                                                                "queries": {
                                                                    "$filter": "FileLeafRef eq '@{triggerBody()?['last_execution_file_name']}.json'",
                                                                    "folderPath": "/Shared Documents/Config/@{triggerBody()?['execution_env']}/@{triggerBody()?['source_name']}",
                                                                    "viewScopeOption": "Default"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "equals": [
                                                                    "@items('For_each_5')?['DisplayName']",
                                                                    "@triggerBody()?['source_name']"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                }
                                            },
                                            "runAfter": {
                                                "List_folder": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Foreach"
                                        },
                                        "List_folder": {
                                            "runAfter": {},
                                            "metadata": {
                                                "%252fShared%2bDocuments%252fConfig": "/Shared Documents/Config"
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                    }
                                                },
                                                "method": "get",
                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent('https://google.sharepoint.com/sites/SEAI-MarketDataLake'))}/folders/@{encodeURIComponent(triggerBody()?['last_execution_file_path_sp'])}"
                                            }
                                        },
                                        "Response_7": {
                                            "runAfter": {
                                                "For_each_5": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@variables('last_execution')",
                                                "statusCode": 200
                                            },
                                            "operationOptions": "Asynchronous"
                                        }
                                    }
                                },
                                "Case_-_Historical_POS": {
                                    "case": "Historical POS",
                                    "actions": {
                                        "Condition_if_Full_Load_Nested_": {
                                            "actions": {
                                                "For_each_\"YEAR\"_loop": {
                                                    "foreach": "@body('List_folder_-_\"YEAR\"')",
                                                    "actions": {
                                                        "Condition_4": {
                                                            "actions": {
                                                                "For_each_\"MONTH\"_loop": {
                                                                    "foreach": "@body('List_folder_\"MONTH\"')",
                                                                    "actions": {
                                                                        "Condition_5": {
                                                                            "actions": {
                                                                                "For_each_3": {
                                                                                    "foreach": "@body('List_folder_2')",
                                                                                    "actions": {
                                                                                        "Create_blob_(V2)_4": {
                                                                                            "runAfter": {
                                                                                                "Get_file_content_3": [
                                                                                                    "Succeeded"
                                                                                                ]
                                                                                            },
                                                                                            "limit": {
                                                                                                "timeout": "P10D"
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "inputs": {
                                                                                                "body": "@body('Get_file_content_3')",
                                                                                                "headers": {
                                                                                                    "ReadFileMetadataFromServer": true
                                                                                                },
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "post",
                                                                                                "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                "queries": {
                                                                                                    "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                    "name": "@{replace(concat(split(item()?['Path'], '/')[sub(length(split(item()?['Path'], '/')), 2)],'_', item()?['DisplayName']), ',','')}",
                                                                                                    "queryParametersSingleEncoded": true
                                                                                                }
                                                                                            },
                                                                                            "runtimeConfiguration": {
                                                                                                "contentTransfer": {
                                                                                                    "transferMode": "Chunked"
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "Get_file_content_3": {
                                                                                            "runAfter": {},
                                                                                            "limit": {
                                                                                                "timeout": "P10D"
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "inputs": {
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "get",
                                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(items('For_each_3')?['Id'])}/content",
                                                                                                "queries": {
                                                                                                    "inferContentType": true
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "runAfter": {
                                                                                        "List_folder_2": [
                                                                                            "Succeeded"
                                                                                        ]
                                                                                    },
                                                                                    "type": "Foreach"
                                                                                },
                                                                                "List_folder_2": {
                                                                                    "runAfter": {},
                                                                                    "limit": {
                                                                                        "timeout": "P10D"
                                                                                    },
                                                                                    "type": "ApiConnection",
                                                                                    "inputs": {
                                                                                        "host": {
                                                                                            "connection": {
                                                                                                "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                            }
                                                                                        },
                                                                                        "method": "get",
                                                                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_\"MONTH\"_loop')?['Id'])}"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "runAfter": {},
                                                                            "else": {
                                                                                "actions": {
                                                                                    "For_each_4": {
                                                                                        "foreach": "@body('List_folder_\"MONTH\"')",
                                                                                        "actions": {
                                                                                            "Create_blob_(V2)_5": {
                                                                                                "runAfter": {
                                                                                                    "Get_file_content_4": [
                                                                                                        "Succeeded"
                                                                                                    ]
                                                                                                },
                                                                                                "limit": {
                                                                                                    "timeout": "P10D"
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "inputs": {
                                                                                                    "body": "@body('Get_file_content_4')",
                                                                                                    "headers": {
                                                                                                        "ReadFileMetadataFromServer": true
                                                                                                    },
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "post",
                                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                    "queries": {
                                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                        "name": "@{replace(concat(split(item()?['Path'], '/')[sub(length(split(item()?['Path'], '/')), 2)],'_', item()?['DisplayName']), ',','')}",
                                                                                                        "queryParametersSingleEncoded": true
                                                                                                    }
                                                                                                },
                                                                                                "runtimeConfiguration": {
                                                                                                    "contentTransfer": {
                                                                                                        "transferMode": "Chunked"
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "Get_file_content_4": {
                                                                                                "runAfter": {},
                                                                                                "limit": {
                                                                                                    "timeout": "P10D"
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "inputs": {
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "get",
                                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(items('For_each_4')?['Id'])}/content",
                                                                                                    "queries": {
                                                                                                        "inferContentType": true
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "runAfter": {},
                                                                                        "type": "Foreach"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "expression": {
                                                                                "and": [
                                                                                    {
                                                                                        "equals": [
                                                                                            "@items('For_each_\"MONTH\"_loop')?['IsFolder']",
                                                                                            "@true"
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                            },
                                                                            "type": "If"
                                                                        }
                                                                    },
                                                                    "runAfter": {
                                                                        "List_folder_\"MONTH\"": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "Foreach"
                                                                },
                                                                "List_folder_\"MONTH\"": {
                                                                    "runAfter": {},
                                                                    "type": "ApiConnection",
                                                                    "inputs": {
                                                                        "host": {
                                                                            "connection": {
                                                                                "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                            }
                                                                        },
                                                                        "method": "get",
                                                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_\"YEAR\"_loop')?['Id'])}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "For_each_YEAR_loop": {
                                                                        "foreach": "@body('List_folder_-_\"YEAR\"')",
                                                                        "actions": {
                                                                            "Create_blob_(V2)_3": {
                                                                                "runAfter": {
                                                                                    "Get_file_content_-_FILES_inside_YEAR": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "limit": {
                                                                                    "timeout": "P10D"
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "body": "@body('Get_file_content_-_FILES_inside_YEAR')",
                                                                                    "headers": {
                                                                                        "ReadFileMetadataFromServer": true
                                                                                    },
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "post",
                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                    "queries": {
                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                        "name": "@{replace(concat(split(item()?['Path'], '/')[sub(length(split(item()?['Path'], '/')), 2)],'_', item()?['DisplayName']), ',','')}",
                                                                                        "queryParametersSingleEncoded": true
                                                                                    }
                                                                                },
                                                                                "runtimeConfiguration": {
                                                                                    "contentTransfer": {
                                                                                        "transferMode": "Chunked"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "Get_file_content_-_FILES_inside_YEAR": {
                                                                                "runAfter": {},
                                                                                "limit": {
                                                                                    "timeout": "P10D"
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(items('For_each_YEAR_loop')?['Id'])}/content",
                                                                                    "queries": {
                                                                                        "inferContentType": true
                                                                                    }
                                                                                }
                                                                            }
                                                                        },
                                                                        "runAfter": {},
                                                                        "type": "Foreach"
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "equals": [
                                                                            "@items('For_each_\"YEAR\"_loop')?['IsFolder']",
                                                                            "@true"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "List_folder_-_\"YEAR\"": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "List_folder_-_\"YEAR\"": {
                                                    "runAfter": {},
                                                    "limit": {
                                                        "timeout": "P10D"
                                                    },
                                                    "metadata": {
                                                        "%252fShared%2bDocuments%252fGeneral%252f03%2bRRHI%2bWeekly%2brct%2bsource%252f04%2bWeekly%2bRCT%2btemplated%2bdata": "/Shared Documents/General/03 RRHI Weekly rct source/04 Weekly RCT templated data",
                                                        "%252fShared%2bDocuments%252fGeneral%252f03%2bWatsons%2bPOS%2brct%2bsource": "/Shared Documents/General/03 Watsons POS rct source"
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                            }
                                                        },
                                                        "method": "get",
                                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(triggerBody()?['Source'])}"
                                                    }
                                                }
                                            },
                                            "runAfter": {},
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@triggerBody()?['full_load']",
                                                            "True"
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Response_4": {
                                "inputs": {
                                    "body": "Pass",
                                    "statusCode": 200
                                },
                                "kind": "Http",
                                "operationOptions": "Asynchronous",
                                "runAfter": {
                                    "Condition_if_Full_Load_Nested_": [
                                        "Succeeded"
                                    ]
                                },
                                "type": "Response"
                            }

                                    }
                                },
                                "Case_-_Incremental": {
                                    "case": "Incremental Load",
                                    "actions": {
                                        "Condition_to_select_newly_uploaded_files_on_sharepoint_and_copy_it,_incremental": {
                                            "actions": {
                                                "For_each": {
                                                    "foreach": "@body('Get_files_(properties_only)')?['value']",
                                                    "actions": {
                                                        "Create_blob_(V2)": {
                                                            "runAfter": {
                                                                "Get_file_content": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "ApiConnection",
                                                            "inputs": {
                                                                "body": "@body('Get_file_content')",
                                                                "headers": {
                                                                    "ReadFileMetadataFromServer": true
                                                                },
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "post",
                                                                "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                "queries": {
                                                                    "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                    "name": "@{items('For_each')?['{FilenameWithExtension}']}",
                                                                    "queryParametersSingleEncoded": true
                                                                }
                                                            },
                                                            "runtimeConfiguration": {
                                                                "contentTransfer": {
                                                                    "transferMode": "Chunked"
                                                                }
                                                            }
                                                        },
                                                        "Get_file_content": {
                                                            "runAfter": {
                                                                "Parse_JSON": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "ApiConnection",
                                                            "inputs": {
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "get",
                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(body('Parse_JSON')?['{Identifier}'])}/content",
                                                                "queries": {
                                                                    "inferContentType": true
                                                                }
                                                            }
                                                        },
                                                        "Parse_JSON": {
                                                            "runAfter": {},
                                                            "type": "ParseJson",
                                                            "inputs": {
                                                                "content": "@items('For_each')",
                                                                "schema": {
                                                                    "properties": {
                                                                        "body": {
                                                                            "properties": {
                                                                                "@@odata.etag": {
                                                                                    "type": "string"
                                                                                },
                                                                                "Author": {
                                                                                    "properties": {
                                                                                        "@@odata.type": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Claims": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "DisplayName": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Email": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Picture": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Author#Claims": {
                                                                                    "type": "string"
                                                                                },
                                                                                "Created": {
                                                                                    "type": "string"
                                                                                },
                                                                                "Editor": {
                                                                                    "properties": {
                                                                                        "@@odata.type": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Claims": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "DisplayName": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Email": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Picture": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Editor#Claims": {
                                                                                    "type": "string"
                                                                                },
                                                                                "ID": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "ItemInternalId": {
                                                                                    "type": "string"
                                                                                },
                                                                                "MediaServiceImageTags": {
                                                                                    "type": "array"
                                                                                },
                                                                                "MediaServiceImageTags#WssId": {
                                                                                    "type": "array"
                                                                                },
                                                                                "MediaServiceImageTags#WssId@odata.type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "MediaServiceImageTags@odata.type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "Modified": {
                                                                                    "type": "string"
                                                                                },
                                                                                "OData__DisplayName": {
                                                                                    "type": "string"
                                                                                },
                                                                                "SharedWithUsers": {
                                                                                    "type": "array"
                                                                                },
                                                                                "SharedWithUsers#Claims": {
                                                                                    "type": "array"
                                                                                },
                                                                                "SharedWithUsers#Claims@odata.type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "SharedWithUsers@odata.type": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{FilenameWithExtension}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{FullPath}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{Identifier}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{IsCheckedOut}": {
                                                                                    "type": "boolean"
                                                                                },
                                                                                "{IsFolder}": {
                                                                                    "type": "boolean"
                                                                                },
                                                                                "{Link}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{Name}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{Path}": {
                                                                                    "type": "string"
                                                                                },
                                                                                "{Thumbnail}": {
                                                                                    "properties": {
                                                                                        "Large": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Medium": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "Small": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "{VersionNumber}": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "type": "Foreach"
                                                },
                                                "Response": {
                                                    "runAfter": {
                                                        "For_each": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Response",
                                                    "kind": "Http",
                                                    "inputs": {
                                                        "body": "Pass",
                                                        "statusCode": 200
                                                    },
                                                    "operationOptions": "Asynchronous"
                                                }
                                            },
                                            "runAfter": {
                                                "Get_files_(properties_only)": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else": {
                                                "actions": {
                                                    "Response_2": {
                                                        "runAfter": {},
                                                        "type": "Response",
                                                        "kind": "Http",
                                                        "inputs": {
                                                            "body": "Files not uploaded",
                                                            "statusCode": 200
                                                        },
                                                        "operationOptions": "Asynchronous"
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "greater": [
                                                            "@length(body('Get_files_(properties_only)')?['value'])",
                                                            0
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "Get_files_(properties_only)": {
                                            "runAfter": {},
                                            "limit": {
                                                "timeout": "P10D"
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                    }
                                                },
                                                "method": "get",
                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                "queries": {
                                                    "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                    "folderPath": "@triggerBody()?['Source']",
                                                    "viewScopeOption": "Default"
                                                }
                                            }
                                        }
                                    }
                                },

                                "Case_-_POWERBI_DATAFLOW_REFRESH": {
                        "actions": {
                            "Refresh_a_dataflow": {
                                "inputs": {
                                    "host": {
                                        "connection": {
                                            "name": "@parameters('$connections')['dataflows']['connectionId']"
                                        }
                                    },
                                    "method": "post",
                                    "path": "/api/groups/@{encodeURIComponent(triggerBody()?['pbi_workspace'])}/dataflows/@{encodeURIComponent(triggerBody()?['pbi_dataflow'])}/refreshdataflow",
                                    "queries": {
                                        "workspaceType": "Workspace"
                                    }
                                },
                                "runAfter": {},
                                "type": "ApiConnection"
                            },
                            "Response_3": {
                                "inputs": {
                                    "body": "Pass",
                                    "statusCode": 200
                                },
                                "kind": "Http",
                                "operationOptions": "Asynchronous",
                                "runAfter": {
                                    "Refresh_a_dataflow": [
                                        "Succeeded"
                                    ]
                                },
                                "type": "Response"
                            }
                        },
                            "case": "POWERBI DATAFLOW REFRESH"
                                  },

                                "Case_-_Incremental_data_load_POS": {
                                    "case": "Incremental Load POS",
                                    "actions": {
                                        "For_each_Year_Folder_or_Files_in_Source_Retailer_Folder": {
                                            "foreach": "@body('List_folder_Source_Retailer')",
                                            "actions": {
                                                "Condition_2": {
                                                    "actions": {
                                                        "For_each_Month_Folder_or_Files_in_Year_Folder": {
                                                            "foreach": "@body('List_folder_Year')",
                                                            "actions": {
                                                                "Condition_8": {
                                                                    "actions": {
                                                                        "Condition_9": {
                                                                            "actions": {
                                                                                "For_each_file_in_Year_Folder_(new_uploads)": {
                                                                                    "foreach": "@body('Get_files_(properties_only)_in_Year_Folder_(new_uploads)')?['value']",
                                                                                    "actions": {
                                                                                        "Create_blob_(V2)_8": {
                                                                                            "runAfter": {
                                                                                                "Get_file_content_6": [
                                                                                                    "Succeeded"
                                                                                                ]
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "runtimeConfiguration": {
                                                                                                "contentTransfer": {
                                                                                                    "transferMode": "Chunked"
                                                                                                }
                                                                                            },
                                                                                            "inputs": {
                                                                                                "body": "@body('Get_file_content_6')",
                                                                                                "headers": {
                                                                                                    "ReadFileMetadataFromServer": true
                                                                                                },
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "post",
                                                                                                "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                "queries": {
                                                                                                    "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                    "name": "@{replace(concat(split(body('Parse_JSON_Properties_of_file_in_Year_folder')?['{FullPath}'], '/')[sub(length(split(body('Parse_JSON_Properties_of_file_in_Year_folder')?['{FullPath}'], '/')), 2)],'_',body('Parse_JSON_Properties_of_file_in_Year_folder')?['{FilenameWithExtension}']),',','')}",
                                                                                                    "queryParametersSingleEncoded": true
                                                                                                }
                                                                                            },
                                                                                            "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                                        },
                                                                                        "Get_file_content_6": {
                                                                                            "runAfter": {
                                                                                                "Parse_JSON_Properties_of_file_in_Year_folder": [
                                                                                                    "Succeeded"
                                                                                                ]
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "inputs": {
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "get",
                                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(body('Parse_JSON_Properties_of_file_in_Year_folder')?['{Identifier}'])}/content",
                                                                                                "queries": {
                                                                                                    "inferContentType": true
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "Parse_JSON_Properties_of_file_in_Year_folder": {
                                                                                            "runAfter": {},
                                                                                            "type": "ParseJson",
                                                                                            "inputs": {
                                                                                                "content": "@items('For_each_file_in_Year_Folder_(new_uploads)')",
                                                                                                "schema": {
                                                                                                    "properties": {
                                                                                                        "@@odata.etag": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Author": {
                                                                                                            "properties": {
                                                                                                                "@@odata.type": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Claims": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "DisplayName": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Email": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Picture": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "Author#Claims": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Created": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Editor": {
                                                                                                            "properties": {
                                                                                                                "@@odata.type": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Claims": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "DisplayName": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Email": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Picture": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "Editor#Claims": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "ID": {
                                                                                                            "type": "integer"
                                                                                                        },
                                                                                                        "ItemInternalId": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Modified": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "OData__DisplayName": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "SharedWithUsers": {
                                                                                                            "type": "array"
                                                                                                        },
                                                                                                        "SharedWithUsers#Claims": {
                                                                                                            "type": "array"
                                                                                                        },
                                                                                                        "SharedWithUsers#Claims@odata.type": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "SharedWithUsers@odata.type": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{FilenameWithExtension}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{FullPath}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Identifier}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{IsCheckedOut}": {
                                                                                                            "type": "boolean"
                                                                                                        },
                                                                                                        "{IsFolder}": {
                                                                                                            "type": "boolean"
                                                                                                        },
                                                                                                        "{Link}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Name}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Path}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Thumbnail}": {
                                                                                                            "properties": {
                                                                                                                "Large": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Medium": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Small": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "{VersionNumber}": {
                                                                                                            "type": "string"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "runAfter": {},
                                                                                    "type": "Foreach"
                                                                                },
                                                                                "Set_variable_4": {
                                                                                    "runAfter": {
                                                                                        "For_each_file_in_Year_Folder_(new_uploads)": [
                                                                                            "Succeeded"
                                                                                        ]
                                                                                    },
                                                                                    "type": "SetVariable",
                                                                                    "inputs": {
                                                                                        "name": "incremental_load_file_exist",
                                                                                        "value": "Pass"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "runAfter": {
                                                                                "Get_files_(properties_only)_in_Year_Folder_(new_uploads)": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "expression": {
                                                                                "and": [
                                                                                    {
                                                                                        "greater": [
                                                                                            "@length(body('Get_files_(properties_only)_in_Year_Folder_(new_uploads)')?['value'])",
                                                                                            0
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                            },
                                                                            "type": "If"
                                                                        },
                                                                        "Get_files_(properties_only)_in_Year_Folder_(new_uploads)": {
                                                                            "runAfter": {},
                                                                            "type": "ApiConnection",
                                                                            "inputs": {
                                                                                "host": {
                                                                                    "connection": {
                                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                    }
                                                                                },
                                                                                "method": "get",
                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                                "queries": {
                                                                                    "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                                    "folderPath": "@items('For_each_Year_Folder_or_Files_in_Source_Retailer_Folder')?['Path']",
                                                                                    "viewScopeOption": "Default"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "else": {
                                                                        "actions": {
                                                                            "Condition_10": {
                                                                                "actions": {
                                                                                    "For_each_file_in_Month_Folder_(new_uploads)": {
                                                                                        "foreach": "@body('Get_files_(properties_only)_in_Month_Folder_(new_uploads)')?['value']",
                                                                                        "actions": {
                                                                                            "Create_blob_(V2)_9": {
                                                                                                "runAfter": {
                                                                                                    "Get_file_content_7": [
                                                                                                        "Succeeded"
                                                                                                    ]
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "runtimeConfiguration": {
                                                                                                    "contentTransfer": {
                                                                                                        "transferMode": "Chunked"
                                                                                                    }
                                                                                                },
                                                                                                "inputs": {
                                                                                                    "body": "@body('Get_file_content_7')",
                                                                                                    "headers": {
                                                                                                        "ReadFileMetadataFromServer": true
                                                                                                    },
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "post",
                                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                    "queries": {
                                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                        "name": "@{replace(concat(split(body('Parse_JSON_Properties_of_files_in_Month_Folder')?['{FullPath}'], '/')[sub(length(split(body('Parse_JSON_Properties_of_files_in_Month_Folder')?['{FullPath}'], '/')), 2)],'_',body('Parse_JSON_Properties_of_files_in_Month_Folder')?['{FilenameWithExtension}']),',','')}",
                                                                                                        "queryParametersSingleEncoded": true
                                                                                                    }
                                                                                                },
                                                                                                "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                                            },
                                                                                            "Get_file_content_7": {
                                                                                                "runAfter": {
                                                                                                    "Parse_JSON_Properties_of_files_in_Month_Folder": [
                                                                                                        "Succeeded"
                                                                                                    ]
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "inputs": {
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "get",
                                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(body('Parse_JSON_Properties_of_files_in_Month_Folder')?['{Identifier}'])}/content",
                                                                                                    "queries": {
                                                                                                        "inferContentType": true
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "Parse_JSON_Properties_of_files_in_Month_Folder": {
                                                                                                "runAfter": {},
                                                                                                "type": "ParseJson",
                                                                                                "inputs": {
                                                                                                    "content": "@items('For_each_file_in_Month_Folder_(new_uploads)')",
                                                                                                    "schema": {
                                                                                                        "properties": {
                                                                                                            "@@odata.etag": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Author": {
                                                                                                                "properties": {
                                                                                                                    "@@odata.type": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Claims": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "DisplayName": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Email": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Picture": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "Author#Claims": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Created": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Editor": {
                                                                                                                "properties": {
                                                                                                                    "@@odata.type": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Claims": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "DisplayName": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Email": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Picture": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "Editor#Claims": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "ID": {
                                                                                                                "type": "integer"
                                                                                                            },
                                                                                                            "ItemInternalId": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "MediaServiceImageTags": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "MediaServiceImageTags#WssId": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "MediaServiceImageTags#WssId@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "MediaServiceImageTags@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Modified": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "OData__DisplayName": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "SharedWithUsers": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "SharedWithUsers#Claims": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "SharedWithUsers#Claims@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "SharedWithUsers@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{FilenameWithExtension}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{FullPath}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Identifier}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{IsCheckedOut}": {
                                                                                                                "type": "boolean"
                                                                                                            },
                                                                                                            "{IsFolder}": {
                                                                                                                "type": "boolean"
                                                                                                            },
                                                                                                            "{Link}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Name}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Path}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Thumbnail}": {
                                                                                                                "properties": {
                                                                                                                    "Large": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Medium": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Small": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "{VersionNumber}": {
                                                                                                                "type": "string"
                                                                                                            }
                                                                                                        },
                                                                                                        "type": "object"
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "runAfter": {},
                                                                                        "type": "Foreach"
                                                                                    },
                                                                                    "Set_variable_6": {
                                                                                        "runAfter": {
                                                                                            "For_each_file_in_Month_Folder_(new_uploads)": [
                                                                                                "Succeeded"
                                                                                            ]
                                                                                        },
                                                                                        "type": "SetVariable",
                                                                                        "inputs": {
                                                                                            "name": "incremental_load_file_exist",
                                                                                            "value": "Pass"
                                                                                        }
                                                                                    }
                                                                                },
                                                                                "runAfter": {
                                                                                    "Get_files_(properties_only)_in_Month_Folder_(new_uploads)": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "expression": {
                                                                                    "and": [
                                                                                        {
                                                                                            "greater": [
                                                                                                "@length(body('Get_files_(properties_only)_in_Month_Folder_(new_uploads)')?['value'])",
                                                                                                0
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                "type": "If"
                                                                            },
                                                                            "Get_files_(properties_only)_in_Month_Folder_(new_uploads)": {
                                                                                "runAfter": {
                                                                                    "List_folder_Month": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                                    "queries": {
                                                                                        "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                                        "folderPath": "@items('For_each_Month_Folder_or_Files_in_Year_Folder')?['Path']",
                                                                                        "viewScopeOption": "Default"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "List_folder_Month": {
                                                                                "runAfter": {},
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_Month_Folder_or_Files_in_Year_Folder')?['Id'])}"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "expression": {
                                                                        "and": [
                                                                            {
                                                                                "equals": [
                                                                                    "@items('For_each_Month_Folder_or_Files_in_Year_Folder')?['IsFolder']",
                                                                                    false
                                                                                ]
                                                                            }
                                                                        ]
                                                                    },
                                                                    "type": "If"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "List_folder_Year": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Foreach"
                                                        },
                                                        "List_folder_Year": {
                                                            "runAfter": {},
                                                            "type": "ApiConnection",
                                                            "inputs": {
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "get",
                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_Year_Folder_or_Files_in_Source_Retailer_Folder')?['Id'])}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "else": {
                                                        "actions": {
                                                            "Condition_7": {
                                                                "actions": {
                                                                    "For_each_8": {
                                                                        "foreach": "@body('Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)')?['value']",
                                                                        "actions": {
                                                                            "Create_blob_(V2)_6": {
                                                                                "runAfter": {
                                                                                    "Get_file_content_5": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "runtimeConfiguration": {
                                                                                    "contentTransfer": {
                                                                                        "transferMode": "Chunked"
                                                                                            }
                                                                                    },
                                                                                "inputs": {
                                                                                    "body": "@body('Get_file_content_5')",
                                                                                    "headers": {
                                                                                        "ReadFileMetadataFromServer": true
                                                                                    },
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "post",
                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                    "queries": {
                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                        "name": "@body('Parse_JSON_3')?['body']?['{FilenameWithExtension}']",
                                                                                        "queryParametersSingleEncoded": true
                                                                                    }
                                                                                },
                                                                                "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                            },
                                                                            "Get_file_content_5": {
                                                                                "runAfter": {
                                                                                    "Parse_JSON_3": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(items('For_each_8')?['{Identifier}'])}/content",
                                                                                    "queries": {
                                                                                        "inferContentType": true
                                                                                    }
                                                                                }
                                                                            },
                                                                            "Parse_JSON_3": {
                                                                                "runAfter": {},
                                                                                "type": "ParseJson",
                                                                                "inputs": {
                                                                                    "content": "@items('For_each_8')",
                                                                                    "schema": {
                                                                                        "properties": {
                                                                                            "@@odata.etag": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Author": {
                                                                                                "properties": {
                                                                                                    "@@odata.type": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Claims": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "DisplayName": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Email": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Picture": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "Author#Claims": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Created": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Editor": {
                                                                                                "properties": {
                                                                                                    "@@odata.type": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Claims": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "DisplayName": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Email": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Picture": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "Editor#Claims": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "ID": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "ItemInternalId": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Modified": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "OData__DisplayName": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "SharedWithUsers": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "SharedWithUsers#Claims": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "SharedWithUsers#Claims@odata.type": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "SharedWithUsers@odata.type": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{FilenameWithExtension}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{FullPath}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Identifier}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{IsCheckedOut}": {
                                                                                                "type": "boolean"
                                                                                            },
                                                                                            "{IsFolder}": {
                                                                                                "type": "boolean"
                                                                                            },
                                                                                            "{Link}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Name}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Path}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Thumbnail}": {
                                                                                                "properties": {
                                                                                                    "Large": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Medium": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Small": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "{VersionNumber}": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    }
                                                                                }
                                                                            }
                                                                        },
                                                                        "runAfter": {},
                                                                        "type": "Foreach"
                                                                    },
                                                                    "Set_variable_3": {
                                                                        "runAfter": {
                                                                            "For_each_8": [
                                                                                "Succeeded"
                                                                            ]
                                                                        },
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "incremental_load_file_exist",
                                                                            "value": "Pass"
                                                                        }
                                                                    }
                                                                },
                                                                "runAfter": {
                                                                    "Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "expression": {
                                                                    "and": [
                                                                        {
                                                                            "greater": [
                                                                                "@length(body('Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)')?['value'])",
                                                                                0
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                "type": "If"
                                                            },
                                                            "Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)": {
                                                                "runAfter": {},
                                                                "type": "ApiConnection",
                                                                "inputs": {
                                                                    "host": {
                                                                        "connection": {
                                                                            "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                                        }
                                                                    },
                                                                    "method": "get",
                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                    "queries": {
                                                                        "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                        "viewScopeOption": "Default"
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "equals": [
                                                                    "@items('For_each_Year_Folder_or_Files_in_Source_Retailer_Folder')?['IsFolder']",
                                                                    true
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                }
                                            },
                                            "runAfter": {
                                                "List_folder_Source_Retailer": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Foreach"
                                        },
                                        "List_folder_Source_Retailer": {
                                            "runAfter": {},
                                            "metadata": {
                                                "%252fShared%2bDocuments%252fLandingSpace%252fLa%2bNueva%252fPH%252fPOS%252f2023": "/Shared Documents/LandingSpace/La Nueva/PH/POS/2023",
                                                "%252fShared%2bDocuments%252fLandingSpace%252fLa%2bNueva%252fPH%252fPOS%252f2023%252f202301%2bJan": "/Shared Documents/LandingSpace/La Nueva/PH/POS/2023/202301 Jan"
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['sharepointonline']['connectionId']"
                                                    }
                                                },
                                                "method": "get",
                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(triggerBody()?['Source'])}"
                                            }
                                        },
                                        "Response_8": {
                                            "runAfter": {
                                                "For_each_Year_Folder_or_Files_in_Source_Retailer_Folder": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@variables('incremental_load_file_exist')",
                                                "statusCode": 200
                                            },
                                            "operationOptions": "Asynchronous"
                                        }
                                    }
                                },
                                "Case_-_Phretailer": {
                                    "case": "PHRetailer",
                                    "actions": {
                                        "For_each_Year_Folder_or_Files_in_phretailer_Folder": {
                                            "foreach": "@body('List_folder_phretailer')",
                                            "actions": {
                                                "Condition_phretailer_2": {
                                                    "actions": {
                                                        "For_each_Month_Folder_or_Files_in_Year_Folder_phretailer": {
                                                            "foreach": "@body('List_folder_Year_phretailer')",
                                                            "actions": {
                                                                "Condition_phretailer_8": {
                                                                    "actions": {
                                                                        "Condition_phretailer_9": {
                                                                            "actions": {
                                                                                "For_each_file_in_Year_Folder_(new_uploads)_phretailer": {
                                                                                    "foreach": "@body('Get_files_(properties_only)_in_Year_Folder_(new_uploads)_phretailer')?['value']",
                                                                                    "actions": {
                                                                                        "Create_blob_(V2)_phretailer_8": {
                                                                                            "runAfter": {
                                                                                                "Get_file_content_phretailer_6": [
                                                                                                    "Succeeded"
                                                                                                ]
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "inputs": {
                                                                                                "body": "@body('Get_file_content_phretailer_6')",
                                                                                                "headers": {
                                                                                                    "ReadFileMetadataFromServer": true
                                                                                                },
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "post",
                                                                                                "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                "queries": {
                                                                                                    "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                    "name": "@{replace(concat(split(body('Parse_JSON_Properties_of_file_in_Year_folder_phretailer')?['{FullPath}'], '/')[sub(length(split(body('Parse_JSON_Properties_of_file_in_Year_folder_phretailer')?['{FullPath}'], '/')), 2)],'_',body('Parse_JSON_Properties_of_file_in_Year_folder_phretailer')?['{FilenameWithExtension}']),',','')}",
                                                                                                    "queryParametersSingleEncoded": true
                                                                                                }
                                                                                            },
                                                                                            "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                                        },
                                                                                        "Get_file_content_phretailer_6": {
                                                                                            "runAfter": {
                                                                                                "Parse_JSON_Properties_of_file_in_Year_folder_phretailer": [
                                                                                                    "Succeeded"
                                                                                                ]
                                                                                            },
                                                                                            "type": "ApiConnection",
                                                                                            "inputs": {
                                                                                                "host": {
                                                                                                    "connection": {
                                                                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                                    }
                                                                                                },
                                                                                                "method": "get",
                                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(body('Parse_JSON_Properties_of_file_in_Year_folder_phretailer')?['{Identifier}'])}/content",
                                                                                                "queries": {
                                                                                                    "inferContentType": true
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "Parse_JSON_Properties_of_file_in_Year_folder_phretailer": {
                                                                                            "runAfter": {},
                                                                                            "type": "ParseJson",
                                                                                            "inputs": {
                                                                                                "content": "@items('For_each_file_in_Year_Folder_(new_uploads)_phretailer')",
                                                                                                "schema": {
                                                                                                    "properties": {
                                                                                                        "@@odata.etag": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Author": {
                                                                                                            "properties": {
                                                                                                                "@@odata.type": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Claims": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "DisplayName": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Email": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Picture": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "Author#Claims": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Created": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Editor": {
                                                                                                            "properties": {
                                                                                                                "@@odata.type": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Claims": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "DisplayName": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Email": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Picture": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "Editor#Claims": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "ID": {
                                                                                                            "type": "integer"
                                                                                                        },
                                                                                                        "ItemInternalId": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "Modified": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "OData__DisplayName": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "SharedWithUsers": {
                                                                                                            "type": "array"
                                                                                                        },
                                                                                                        "SharedWithUsers#Claims": {
                                                                                                            "type": "array"
                                                                                                        },
                                                                                                        "SharedWithUsers#Claims@odata.type": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "SharedWithUsers@odata.type": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{FilenameWithExtension}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{FullPath}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Identifier}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{IsCheckedOut}": {
                                                                                                            "type": "boolean"
                                                                                                        },
                                                                                                        "{IsFolder}": {
                                                                                                            "type": "boolean"
                                                                                                        },
                                                                                                        "{Link}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Name}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Path}": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "{Thumbnail}": {
                                                                                                            "properties": {
                                                                                                                "Large": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Medium": {
                                                                                                                    "type": "string"
                                                                                                                },
                                                                                                                "Small": {
                                                                                                                    "type": "string"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "{VersionNumber}": {
                                                                                                            "type": "string"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "runAfter": {},
                                                                                    "type": "Foreach"
                                                                                },
                                                                                "Set_variable_phretailer_4": {
                                                                                    "runAfter": {
                                                                                        "For_each_file_in_Year_Folder_(new_uploads)_phretailer": [
                                                                                            "Succeeded"
                                                                                        ]
                                                                                    },
                                                                                    "type": "SetVariable",
                                                                                    "inputs": {
                                                                                        "name": "incremental_load_file_exist",
                                                                                        "value": "Pass"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "runAfter": {
                                                                                "Get_files_(properties_only)_in_Year_Folder_(new_uploads)_phretailer": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "expression": {
                                                                                "and": [
                                                                                    {
                                                                                        "greater": [
                                                                                            "@length(body('Get_files_(properties_only)_in_Year_Folder_(new_uploads)_phretailer')?['value'])",
                                                                                            0
                                                                                        ]
                                                                                    }
                                                                                ]
                                                                            },
                                                                            "type": "If"
                                                                        },
                                                                        "Get_files_(properties_only)_in_Year_Folder_(new_uploads)_phretailer": {
                                                                            "runAfter": {},
                                                                            "type": "ApiConnection",
                                                                            "inputs": {
                                                                                "host": {
                                                                                    "connection": {
                                                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                    }
                                                                                },
                                                                                "method": "get",
                                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                                "queries": {
                                                                                    "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                                    "folderPath": "@items('For_each_Year_Folder_or_Files_in_phretailer_Folder')?['Path']",
                                                                                    "viewScopeOption": "Default"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "else": {
                                                                        "actions": {
                                                                            "Condition_phretailer_10": {
                                                                                "actions": {
                                                                                    "For_each_file_in_Month_Folder_(new_uploads)_phretailer": {
                                                                                        "foreach": "@body('Get_files_(properties_only)_in_Month_Folder_(new_uploads)_phretailer')?['value']",
                                                                                        "actions": {
                                                                                            "Create_blob_(V2)_phretailer_9": {
                                                                                                "runAfter": {
                                                                                                    "Get_file_content_phretailer_7": [
                                                                                                        "Succeeded"
                                                                                                    ]
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "inputs": {
                                                                                                    "body": "@body('Get_file_content_phretailer_7')",
                                                                                                    "headers": {
                                                                                                        "ReadFileMetadataFromServer": true
                                                                                                    },
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "post",
                                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                                    "queries": {
                                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                                        "name": "@{replace(concat(split(body('Parse_JSON_Properties_of_files_in_Month_Folder_phretailer')?['{FullPath}'], '/')[sub(length(split(body('Parse_JSON_Properties_of_files_in_Month_Folder_phretailer')?['{FullPath}'], '/')), 2)],'_',body('Parse_JSON_Properties_of_files_in_Month_Folder_phretailer')?['{FilenameWithExtension}']),',','')}",
                                                                                                        "queryParametersSingleEncoded": true
                                                                                                    }
                                                                                                },
                                                                                                "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                                            },
                                                                                            "Get_file_content_phretailer_7": {
                                                                                                "runAfter": {
                                                                                                    "Parse_JSON_Properties_of_files_in_Month_Folder_phretailer": [
                                                                                                        "Succeeded"
                                                                                                    ]
                                                                                                },
                                                                                                "type": "ApiConnection",
                                                                                                "inputs": {
                                                                                                    "host": {
                                                                                                        "connection": {
                                                                                                            "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                                        }
                                                                                                    },
                                                                                                    "method": "get",
                                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(body('Parse_JSON_Properties_of_files_in_Month_Folder_phretailer')?['{Identifier}'])}/content",
                                                                                                    "queries": {
                                                                                                        "inferContentType": true
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            "Parse_JSON_Properties_of_files_in_Month_Folder_phretailer": {
                                                                                                "runAfter": {},
                                                                                                "type": "ParseJson",
                                                                                                "inputs": {
                                                                                                    "content": "@items('For_each_file_in_Month_Folder_(new_uploads)_phretailer')",
                                                                                                    "schema": {
                                                                                                        "properties": {
                                                                                                            "@@odata.etag": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Author": {
                                                                                                                "properties": {
                                                                                                                    "@@odata.type": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Claims": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "DisplayName": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Email": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Picture": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "Author#Claims": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Created": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Editor": {
                                                                                                                "properties": {
                                                                                                                    "@@odata.type": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Claims": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "DisplayName": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Email": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Picture": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "Editor#Claims": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "ID": {
                                                                                                                "type": "integer"
                                                                                                            },
                                                                                                            "ItemInternalId": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "MediaServiceImageTags": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "MediaServiceImageTags#WssId": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "MediaServiceImageTags#WssId@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "MediaServiceImageTags@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "Modified": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "OData__DisplayName": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "SharedWithUsers": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "SharedWithUsers#Claims": {
                                                                                                                "type": "array"
                                                                                                            },
                                                                                                            "SharedWithUsers#Claims@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "SharedWithUsers@odata.type": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{FilenameWithExtension}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{FullPath}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Identifier}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{IsCheckedOut}": {
                                                                                                                "type": "boolean"
                                                                                                            },
                                                                                                            "{IsFolder}": {
                                                                                                                "type": "boolean"
                                                                                                            },
                                                                                                            "{Link}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Name}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Path}": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "{Thumbnail}": {
                                                                                                                "properties": {
                                                                                                                    "Large": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Medium": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "Small": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "{VersionNumber}": {
                                                                                                                "type": "string"
                                                                                                            }
                                                                                                        },
                                                                                                        "type": "object"
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        "runAfter": {},
                                                                                        "type": "Foreach"
                                                                                    },
                                                                                    "Set_variable_phretailer_6": {
                                                                                        "runAfter": {
                                                                                            "For_each_file_in_Month_Folder_(new_uploads)_phretailer": [
                                                                                                "Succeeded"
                                                                                            ]
                                                                                        },
                                                                                        "type": "SetVariable",
                                                                                        "inputs": {
                                                                                            "name": "incremental_load_file_exist",
                                                                                            "value": "Pass"
                                                                                        }
                                                                                    }
                                                                                },
                                                                                "runAfter": {
                                                                                    "Get_files_(properties_only)_in_Month_Folder_(new_uploads)_phretailer": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "expression": {
                                                                                    "and": [
                                                                                        {
                                                                                            "greater": [
                                                                                                "@length(body('Get_files_(properties_only)_in_Month_Folder_(new_uploads)_phretailer')?['value'])",
                                                                                                0
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                "type": "If"
                                                                            },
                                                                            "Get_files_(properties_only)_in_Month_Folder_(new_uploads)_phretailer": {
                                                                                "runAfter": {
                                                                                    "List_folder_Month_phretailer": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                                    "queries": {
                                                                                        "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                                        "folderPath": "@items('For_each_Month_Folder_or_Files_in_Year_Folder_phretailer')?['Path']",
                                                                                        "viewScopeOption": "Default"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "List_folder_Month_phretailer": {
                                                                                "runAfter": {},
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_Month_Folder_or_Files_in_Year_Folder_phretailer')?['Id'])}"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "expression": {
                                                                        "and": [
                                                                            {
                                                                                "equals": [
                                                                                    "@items('For_each_Month_Folder_or_Files_in_Year_Folder_phretailer')?['IsFolder']",
                                                                                    false
                                                                                ]
                                                                            }
                                                                        ]
                                                                    },
                                                                    "type": "If"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "List_folder_Year_phretailer": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Foreach"
                                                        },
                                                        "List_folder_Year_phretailer": {
                                                            "runAfter": {},
                                                            "type": "ApiConnection",
                                                            "inputs": {
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "get",
                                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(items('For_each_Year_Folder_or_Files_in_phretailer_Folder')?['Id'])}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {},
                                                    "else": {
                                                        "actions": {
                                                            "Condition_phretailer_7": {
                                                                "actions": {
                                                                    "For_each_phretailer_8": {
                                                                        "foreach": "@body('Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)_phretailer')?['value']",
                                                                        "actions": {
                                                                            "Create_blob_(V2)_phretailer_6": {
                                                                                "runAfter": {
                                                                                    "Get_file_content_phretailer_5": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "body": "@body('Get_file_content_phretailer_5')",
                                                                                    "headers": {
                                                                                        "ReadFileMetadataFromServer": true
                                                                                    },
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['azureblob']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "post",
                                                                                    "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                                                                                    "queries": {
                                                                                        "folderPath": "@triggerBody()?['Blob_Destination']",
                                                                                        "name": "@body('Parse_JSON_phretailer_3')?['body']?['{FilenameWithExtension}']",
                                                                                        "queryParametersSingleEncoded": true
                                                                                    }
                                                                                },
                                                                                "operationOptions": "DisableAsyncPattern, DisableAutomaticDecompression"
                                                                            },
                                                                            "Get_file_content_phretailer_5": {
                                                                                "runAfter": {
                                                                                    "Parse_JSON_phretailer_3": [
                                                                                        "Succeeded"
                                                                                    ]
                                                                                },
                                                                                "type": "ApiConnection",
                                                                                "inputs": {
                                                                                    "host": {
                                                                                        "connection": {
                                                                                            "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                                        }
                                                                                    },
                                                                                    "method": "get",
                                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/files/@{encodeURIComponent(items('For_each_phretailer_8')?['{Identifier}'])}/content",
                                                                                    "queries": {
                                                                                        "inferContentType": true
                                                                                    }
                                                                                }
                                                                            },
                                                                            "Parse_JSON_phretailer_3": {
                                                                                "runAfter": {},
                                                                                "type": "ParseJson",
                                                                                "inputs": {
                                                                                    "content": "@items('For_each_phretailer_8')",
                                                                                    "schema": {
                                                                                        "properties": {
                                                                                            "@@odata.etag": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Author": {
                                                                                                "properties": {
                                                                                                    "@@odata.type": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Claims": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "DisplayName": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Email": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Picture": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "Author#Claims": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Created": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Editor": {
                                                                                                "properties": {
                                                                                                    "@@odata.type": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Claims": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "DisplayName": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Email": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Picture": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "Editor#Claims": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "ID": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "ItemInternalId": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "Modified": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "OData__DisplayName": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "SharedWithUsers": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "SharedWithUsers#Claims": {
                                                                                                "type": "array"
                                                                                            },
                                                                                            "SharedWithUsers#Claims@odata.type": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "SharedWithUsers@odata.type": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{FilenameWithExtension}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{FullPath}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Identifier}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{IsCheckedOut}": {
                                                                                                "type": "boolean"
                                                                                            },
                                                                                            "{IsFolder}": {
                                                                                                "type": "boolean"
                                                                                            },
                                                                                            "{Link}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Name}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Path}": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "{Thumbnail}": {
                                                                                                "properties": {
                                                                                                    "Large": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Medium": {
                                                                                                        "type": "string"
                                                                                                    },
                                                                                                    "Small": {
                                                                                                        "type": "string"
                                                                                                    }
                                                                                                },
                                                                                                "type": "object"
                                                                                            },
                                                                                            "{VersionNumber}": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    }
                                                                                }
                                                                            }
                                                                        },
                                                                        "runAfter": {},
                                                                        "type": "Foreach"
                                                                    },
                                                                    "Set_variable_phretailer_3": {
                                                                        "runAfter": {
                                                                            "For_each_phretailer_8": [
                                                                                "Succeeded"
                                                                            ]
                                                                        },
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "incremental_load_file_exist",
                                                                            "value": "Pass"
                                                                        }
                                                                    }
                                                                },
                                                                "runAfter": {
                                                                    "Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)_phretailer": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "expression": {
                                                                    "and": [
                                                                        {
                                                                            "greater": [
                                                                                "@length(body('Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)_phretailer')?['value'])",
                                                                                0
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                "type": "If"
                                                            },
                                                            "Get_files_(properties_only)_in_Source_Retailer_Folder_(new_uploads)_phretailer": {
                                                                "runAfter": {},
                                                                "type": "ApiConnection",
                                                                "inputs": {
                                                                    "host": {
                                                                        "connection": {
                                                                            "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                                        }
                                                                    },
                                                                    "method": "get",
                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/tables/@{encodeURIComponent(encodeURIComponent(triggerBody()?['library_name']))}/getfileitems",
                                                                    "queries": {
                                                                        "$filter": "(@{triggerBody()?['column_name']} ge '@{triggerBody()?['last_execution']}') and (substringof('@{triggerBody()?['Contains']}', FileLeafRef))",
                                                                        "viewScopeOption": "Default"
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "equals": [
                                                                    "@items('For_each_Year_Folder_or_Files_in_phretailer_Folder')?['IsFolder']",
                                                                    true
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                }
                                            },
                                            "runAfter": {
                                                "List_folder_phretailer": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Foreach"
                                        },
                                        "List_folder_phretailer": {
                                            "runAfter": {},
                                            "metadata": {
                                                "%252fShared%2bDocuments%252fGeneral%252fRRHI%2bFCDS%2bMDL%252f03%2bRRHI%2bFCDS%2bFull%2bCat%2bHair%2b%252b%2bDeos": "/Shared Documents/General/RRHI FCDS MDL/03 RRHI FCDS Full Cat Hair + Deos",
                                                "%252fShared%2bDocuments%252fLandingSpace%252fLa%2bNueva%252fPH%252fPOS%252f2023": "/Shared Documents/LandingSpace/La Nueva/PH/POS/2023",
                                                "%252fShared%2bDocuments%252fLandingSpace%252fLa%2bNueva%252fPH%252fPOS%252f2023%252f202301%2bJan": "/Shared Documents/LandingSpace/La Nueva/PH/POS/2023/202301 Jan"
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['sharepointonline_PH']['connectionId']"
                                                    }
                                                },
                                                "method": "get",
                                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(triggerBody()?['Site']))}/folders/@{encodeURIComponent(triggerBody()?['Source'])}"
                                            }
                                        },
                                        "Response_phretailer_8": {
                                            "runAfter": {
                                                "For_each_Year_Folder_or_Files_in_phretailer_Folder": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@variables('incremental_load_file_exist')",
                                                "statusCode": 200
                                            },
                                            "operationOptions": "Asynchronous"
                                        }
                                    }
                                }
                            },
                            "default": {
                                "actions": {}
                            },
                            "expression": "@triggerBody()?['Logic Apps Case']",
                            "type": "Switch"
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
					"$connections": {
						"value": {
							"azureblob": {
								"connectionId": "[resourceId('Microsoft.Web/connections', parameters('logicAppStorageConnectionName'))]",
								"connectionName": "[parameters('logicAppStorageConnectionName')]",
								"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'azureblob')]"
							},
							"office365": {
								"connectionId": "[resourceId('Microsoft.Web/connections', parameters('logicAppO365apiConnection'))]",
								"connectionName": "office365",
								"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'office365')]"
							},
							"sharepointonline_PH": {
								"connectionId": "[resourceId('Microsoft.Web/connections', parameters('PHlogicAppSharePointConnectionName'))]",
								"connectionName": "[parameters('PHlogicAppSharePointConnectionName')]",
								"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'sharepointonline')]"
							},
							"sharepointonline": {
								"connectionId": "[resourceId('Microsoft.Web/connections', parameters('logicAppSharePointConnectionName'))]",
								"connectionName": "[parameters('logicAppSharePointConnectionName')]",
								"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'sharepointonline')]"
							},
                            "dataflows": {
								"connectionId": "[resourceId('Microsoft.Web/connections', parameters('PHlogicAppPowerBIConnectionName'))]",
								"connectionName": "[parameters('PHlogicAppPowerBIConnectionName')]",
								"id": "[concat(subscription().id, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/', 'dataflows')]"
							}

						}
					}
				}
            },
            "dependsOn": [
				"[resourceId('Microsoft.Web/connections', parameters('PHlogicAppSharePointConnectionName'))]"
			]
        }
    ]
}
